<head>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<style>
  .fullHeight {
    min-height: 90vh;
  }
</style>
<body class="has-background-danger-95 fullHeight">
  <section class="section fullHeight">
    <nav class="level-right">
      <div class="level-right">
        <article class="message">
          <div class="message-body" id="timer"></div>
        </article>
      </div>
    </nav>
    <div class="container">
      <% for (let pregunta of preguntas) { %>
      <p class="subtitle is-2">Pregunta <%= pregunta.numeroPregunta16PF %></p>
      <p class="subtitle is-3"><%= pregunta.pregunta16PF %></p>
      <% if (pregunta.opciones) { %> <% pregunta.opciones.forEach(opcion => { %>
      <div class="control">
        <label class="radio mx-5 subtitle is-4">
          <input
            type="radio"
            name="answer"
            value="<%= opcion.idOpcion16PF %>" />
          <%= opcion.descripcionOpcion16PF %>
        </label>
      </div>
      <% }); %> <% } %> <% } %>
      <form action="/siguiente_pregunta/<%= prueba.idPrueba %>" method="POST">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
        <button class="column is-narrow button mt-3">Siguiente</button>
      </form>
    </div>
  </section>
</body>
<script>
  let duracionMinutos = <%=prueba.duracion%>;
  let totalSegundos = duracionMinutos * 60;
  let cuentaRegresiva = setInterval(function() {
      let horas = Math.floor(totalSegundos / 3600);
      let minutos = Math.floor((totalSegundos % 3600) / 60);
      let segundos = totalSegundos % 60;
      let formatoTiempo = `${horas}:${String(minutos).padStart(2, '0')}:${String(segundos).padStart(2, '0')}`;
      document.getElementById("timer").innerHTML = formatoTiempo;
      totalSegundos--;
      if (totalSegundos < 0) {
          clearInterval(cuentaRegresiva);
          document.getElementById("timer").innerHTML = "TIME UP";
      }
  }, 1000);
</script>